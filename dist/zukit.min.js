(function () {
  'use strict';

  function _defineProperty(obj, key, value) {
    if (key in obj) {
      Object.defineProperty(obj, key, {
        value: value,
        enumerable: true,
        configurable: true,
        writable: true
      });
    } else {
      obj[key] = value;
    }

    return obj;
  }

  function _extends() {
    _extends = Object.assign || function (target) {
      for (var i = 1; i < arguments.length; i++) {
        var source = arguments[i];

        for (var key in source) {
          if (Object.prototype.hasOwnProperty.call(source, key)) {
            target[key] = source[key];
          }
        }
      }

      return target;
    };

    return _extends.apply(this, arguments);
  }

  function ownKeys(object, enumerableOnly) {
    var keys = Object.keys(object);

    if (Object.getOwnPropertySymbols) {
      var symbols = Object.getOwnPropertySymbols(object);
      if (enumerableOnly) symbols = symbols.filter(function (sym) {
        return Object.getOwnPropertyDescriptor(object, sym).enumerable;
      });
      keys.push.apply(keys, symbols);
    }

    return keys;
  }

  function _objectSpread2(target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i] != null ? arguments[i] : {};

      if (i % 2) {
        ownKeys(Object(source), true).forEach(function (key) {
          _defineProperty(target, key, source[key]);
        });
      } else if (Object.getOwnPropertyDescriptors) {
        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));
      } else {
        ownKeys(Object(source)).forEach(function (key) {
          Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
        });
      }
    }

    return target;
  }

  function _objectWithoutPropertiesLoose(source, excluded) {
    if (source == null) return {};
    var target = {};
    var sourceKeys = Object.keys(source);
    var key, i;

    for (i = 0; i < sourceKeys.length; i++) {
      key = sourceKeys[i];
      if (excluded.indexOf(key) >= 0) continue;
      target[key] = source[key];
    }

    return target;
  }

  function _objectWithoutProperties(source, excluded) {
    if (source == null) return {};

    var target = _objectWithoutPropertiesLoose(source, excluded);

    var key, i;

    if (Object.getOwnPropertySymbols) {
      var sourceSymbolKeys = Object.getOwnPropertySymbols(source);

      for (i = 0; i < sourceSymbolKeys.length; i++) {
        key = sourceSymbolKeys[i];
        if (excluded.indexOf(key) >= 0) continue;
        if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;
        target[key] = source[key];
      }
    }

    return target;
  }

  function _slicedToArray(arr, i) {
    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();
  }

  function _arrayWithHoles(arr) {
    if (Array.isArray(arr)) return arr;
  }

  function _iterableToArrayLimit(arr, i) {
    if (typeof Symbol === "undefined" || !(Symbol.iterator in Object(arr))) return;
    var _arr = [];
    var _n = true;
    var _d = false;
    var _e = undefined;

    try {
      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
        _arr.push(_s.value);

        if (i && _arr.length === i) break;
      }
    } catch (err) {
      _d = true;
      _e = err;
    } finally {
      try {
        if (!_n && _i["return"] != null) _i["return"]();
      } finally {
        if (_d) throw _e;
      }
    }

    return _arr;
  }

  function _unsupportedIterableToArray(o, minLen) {
    if (!o) return;
    if (typeof o === "string") return _arrayLikeToArray(o, minLen);
    var n = Object.prototype.toString.call(o).slice(8, -1);
    if (n === "Object" && o.constructor) n = o.constructor.name;
    if (n === "Map" || n === "Set") return Array.from(o);
    if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);
  }

  function _arrayLikeToArray(arr, len) {
    if (len == null || len > arr.length) len = arr.length;

    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];

    return arr2;
  }

  function _nonIterableRest() {
    throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
  }

  function createCommonjsModule(fn, basedir, module) {
  	return module = {
  	  path: basedir,
  	  exports: {},
  	  require: function (path, base) {
        return commonjsRequire(path, (base === undefined || base === null) ? module.path : base);
      }
  	}, fn(module, module.exports), module.exports;
  }

  function commonjsRequire () {
  	throw new Error('Dynamic requires are not currently supported by @rollup/plugin-commonjs');
  }

  var classnames = createCommonjsModule(function (module) {
  /*!
    Copyright (c) 2017 Jed Watson.
    Licensed under the MIT License (MIT), see
    http://jedwatson.github.io/classnames
  */
  /* global define */

  (function () {

  	var hasOwn = {}.hasOwnProperty;

  	function classNames () {
  		var classes = [];

  		for (var i = 0; i < arguments.length; i++) {
  			var arg = arguments[i];
  			if (!arg) continue;

  			var argType = typeof arg;

  			if (argType === 'string' || argType === 'number') {
  				classes.push(arg);
  			} else if (Array.isArray(arg) && arg.length) {
  				var inner = classNames.apply(null, arg);
  				if (inner) {
  					classes.push(inner);
  				}
  			} else if (argType === 'object') {
  				for (var key in arg) {
  					if (hasOwn.call(arg, key) && arg[key]) {
  						classes.push(key);
  					}
  				}
  			}
  		}

  		return classes.join(' ');
  	}

  	if ( module.exports) {
  		classNames.default = classNames;
  		module.exports = classNames;
  	} else {
  		window.classNames = classNames;
  	}
  }());
  });

  // External dependencies

  var _ = lodash; // Internal dependencies
  // import { useNoticesContext } from './data/with-notices-context.js';
  // Gets JSON data from PHP

  function externalData(key) {
    var _ref = window[key] || {},
        _ref$data = _ref.data,
        data = _ref$data === void 0 ? {} : _ref$data;

    return data;
  }
  var emptyGif = 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=='; // Just a more familiar name

  var mergeClasses = classnames; // Checks if value can be converted to Number

  function isNum(n) {
    return !_.isNaN(parseFloat(n)) && isFinite(n);
  } // convert argument to Boolean value
  // works for true, false, 0, 1, "true", "false", "TRUE", "FALSE", "0", "1", undefined

  function toBool(val) {
    var num;
    return val != null && (!_.isNaN(num = +val) ? !!num : !!String(val).toLowerCase().replace(!!0, ''));
  }
  function toRange(num, min, max) {
    var useMinOnErr = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;
    var value = _.isNaN(+num) ? useMinOnErr ? min : max : num;
    return _.clamp(_.round(value), min, max);
  } // Create key for react components from 'value' or other params

  function getKey(value, more) {
    var source = _.isString(value) || isNum(value) ? String(value) : String(more);
    var hash = 0,
        i;

    for (i = 0; i < source.length; i++) {
      hash = (hash << 5) - hash + source.charCodeAt(i);
      hash |= 0; // Convert to 32bit integer
    }

    return String(hash);
  }
  function isWrongId(id) {
    return _.isNil(id) || isNum(id) && parseInt(id, 10) === 0;
  } // Creates an 'ids' array from an array (which should have property 'id').
  // Ensures the ids array contains numbers

  function getIds(items) {
    var asString = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    // always ensure the ids array contains numbers.
    // And remove all elements with "empty" value (undefined, null)
    if (!items || items.length === 0) return asString ? '' : [];

    var ids = _.compact(_.map(items, function (value) {
      return value && value.id && parseInt(value.id, 10);
    }));

    return asString ? _.join(ids, ',') : ids;
  }
  function checkDependency(item, options) {
    var isAction = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
    var depends = isAction ? item : _.get(item, 'depends');
    if (_.isNil(depends)) return true;
    if (depends === false) return false;

    var value = options[_.trimStart(depends, '!')];

    return _.startsWith(depends, '!') ? !value : value;
  } // Returns SVG with a reference to an already loaded SVG set

  function getSvg(id) {
    var icon = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    var moreClasses = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';
    var size = 24; // change viewBox values according to Icons Set

    return /*#__PURE__*/React.createElement("svg", {
      className: classnames('zu-svg', {
        icon: icon
      }, "icon-".concat(id), moreClasses),
      role: "img",
      "aria-labelledby": "title",
      viewBox: "0 0 ".concat(size, " ").concat(size),
      preserveAspectRatio: "xMidYMin slice"
    }, /*#__PURE__*/React.createElement("use", {
      href: "#".concat(id)
    }));
  }

  var utils = /*#__PURE__*/Object.freeze({
    __proto__: null,
    externalData: externalData,
    emptyGif: emptyGif,
    mergeClasses: mergeClasses,
    isNum: isNum,
    toBool: toBool,
    toRange: toRange,
    getKey: getKey,
    isWrongId: isWrongId,
    getIds: getIds,
    checkDependency: checkDependency,
    getSvg: getSvg
  });

  // WordPress dependencies
  var _$1 = lodash;
  var _wp = wp,
      apiFetch = _wp.apiFetch; // Internal dependencies
  // import { useNoticesContext } from './data/with-notices-context.js';

  var cacheKey = 'cache';
  var apiBaseURL = '/zukit/v1/'; // Ajax actions and options update --------------------------------------------]
  // Если status === 'data' просто возвращаем данные из проперти 'data',
  // в противном случае формируем и отображаем 'Notice'

  function onSuccessAjax(createNotice, request) {
    var callback = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
    var loading = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;

    var actionKey = _$1.get(request, 'options.key');

    var actionData = [{
      className: 'zukit-data',
      label: actionKey
    }];
    return function (ajaxData) {
      var _ref = ajaxData || {},
          _ref$status = _ref.status,
          status = _ref$status === void 0 ? 'warning' : _ref$status,
          content = _ref.content,
          _ref$data = _ref.data,
          data = _ref$data === void 0 ? null : _ref$data,
          withData = _ref.withData,
          _ref$withHTML = _ref.withHTML,
          withHTML = _ref$withHTML === void 0 ? true : _ref$withHTML,
          message = _ref.message,
          params = _ref.params; // mark action as 'complete'


      if (_$1.isFunction(loading)) loading(_defineProperty({}, actionKey, false)); // Если 'notice' combined with 'data' - transform to 'real' status

      if (_$1.includes(status, 'data')) {
        status = status.replace('data', '');
        withData = true;
      } // if 'data' - pass it to callback


      if (status === 'data' || withData) {
        if (_$1.isFunction(callback)) callback(data);
      } // if 'soft' error message


      if (status === false && message) {
        status = 'error';
        content = message;
        if (params) params = [{
          className: 'zukit-data',
          label: params
        }];
      }

      if (_$1.isNil(content)) {
        content = 'Unknown action:';
        params = actionData;
      }

      if (status !== 'data' && !withData) {
        createNotice({
          status: status,
          // Can be one of: success, info, warning, error
          content: content,
          // Text string to display
          isDismissible: true,
          // Whether the user can dismiss the notice
          actions: params,
          // Any actions the user can perform
          __unstableHTML: withHTML
        });
      }
    };
  }

  function onErrorAjax(createNotice, request, loading) {
    var requestKey = _$1.get(request, 'options.key') || _$1.get(request, 'options.keys');

    return function (error) {
      // mark action as 'complete'
      if (_$1.isFunction(loading)) loading(_defineProperty({}, requestKey, false));
      var _error$message = error.message,
          message = _error$message === void 0 ? 'Unknown error:' : _error$message;
      createNotice({
        status: 'error',
        // Can be one of: success, info, warning, error
        content: message,
        // Text string to display
        isDismissible: true,
        // Whether the user can dismiss the notice
        actions: [{
          className: 'zukit-data',
          label: requestKey
        }],
        __unstableHTML: true
      });
    };
  }

  function hookOptionsUpdate(updateValues, hooks) {
    var updateKey = _$1.first(_$1.keys(updateValues));

    var updateHook = _$1.get(hooks, updateKey);

    if (!_$1.isFunction(updateHook)) return _$1.noop;
    return function () {
      return updateHook(updateKey, updateValues[updateKey]);
    };
  }

  function hookOptionsReset(options, hooks) {
    var _ref2 = options || {},
        _ref2$prev = _ref2.prev,
        prev = _ref2$prev === void 0 ? {} : _ref2$prev,
        _ref2$next = _ref2.next,
        next = _ref2$next === void 0 ? {} : _ref2$next;

    _$1.forEach(hooks || {}, function (hook, key) {
      // call hook only if value is changed
      if (_$1.isFunction(hook) && prev[key] !== next[key]) hook(key, next[key]);
    });
  }

  function ajaxDoAction(params, callback, createNotice, updateLoading) {
    var _ref3 = _$1.isPlainObject(params) ? params : {
      action: params
    },
        action = _ref3.action,
        _ref3$value = _ref3.value,
        value = _ref3$value === void 0 ? null : _ref3$value;

    var requestData = {
      route: 'action',
      options: {
        key: action,
        value: value
      }
    }; // mark action as 'loading'

    updateLoading(_defineProperty({}, action, true));
    postAndCatchWithOptions(_objectSpread2(_objectSpread2({}, requestData), {}, {
      onSuccess: onSuccessAjax(createNotice, requestData, callback, updateLoading),
      onError: onErrorAjax(createNotice, requestData, updateLoading)
    }));
  }
  function ajaxUpdateOptions(keys, values, createNotice, updateHooks) {
    // если 'keys' is null - значит это options reset и просто проверяем все hooks
    if (keys === null) {
      hookOptionsReset(values, updateHooks);
      return;
    } // если 'keys' простая строка и 'values' не содержит такого ключа - преобразовать
    // 'values' в нужную форму


    if (_$1.isString(keys) && !_$1.has(values, keys)) values = _defineProperty({}, keys, values);
    var requestData = {
      route: 'options',
      options: {
        keys: keys,
        values: values
      }
    };
    postAndCatchWithOptions(_objectSpread2(_objectSpread2({}, requestData), {}, {
      onSuccess: hookOptionsUpdate(values, updateHooks),
      onError: onErrorAjax(createNotice)
    }));
  } // Some helpers for API fetch -------------------------------------------------]
  // Convert object to JSON

  function toJSON(obj) {
    if (obj) {
      try {
        obj = JSON.stringify(obj);
      } catch (err) {
        obj = '{}';
      }
    }

    return obj || '{}';
  } // Convert object to query string and skip "unwanted" properties

  function serializeData(data) {
    var cache = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    var skip = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];

    // remove all elements with "empty" value (undefined, null)
    var obj = _$1.omitBy(data, _$1.isNil); // check for cacheKey in object and then remove it (skip) from serialization


    if (_$1.has(obj, cacheKey)) {
      cache = obj[cacheKey];
      skip.push(cacheKey);
    }

    var str = [];

    for (var p in obj) {
      if (_$1.has(obj, p) && !_$1.includes(skip, p)) {
        // process array as JSON if presented in value
        var value = _$1.isArray(obj[p]) ? toJSON(obj[p]) : obj[p];
        str.push("".concat(encodeURIComponent(p), "=").concat(encodeURIComponent(value)));
      }
    }

    if (cache) {
      var random = Math.floor(Math.random() * 1000000);
      str.push("q=".concat(random));
    }

    return str.join('&');
  } // Check URL and transform it if needed


  function requestURL(url, options) {
    var picked = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];
    // extend url with API base
    // and remove any leading and trailing slashes
    var requestUrl = !_$1.startsWith(url, apiBaseURL) ? apiBaseURL + url.replace(/^\\+|\\+$/g, '') : url.replace(/\\+$/g, ''); // maybe pick only some keys

    var urlOptions = !_$1.isEmpty(picked) ? _$1.pick(options, picked) : options; // convert data to query string for requests without BODY

    if (!_$1.isEmpty(urlOptions)) requestUrl = "".concat(requestUrl, "/?").concat(serializeData(urlOptions, urlOptions.cache));
    return requestUrl;
  } // create GET API Promise with Route and Options, then execute it and process results with callbacks

  function fetchAndCatchWithOptions(_ref4) {
    var route = _ref4.route,
        options = _ref4.options,
        picked = _ref4.picked,
        onSuccess = _ref4.onSuccess,
        onError = _ref4.onError;
    apiFetch({
      path: requestURL(route, options, picked)
    }).then(function (data) {
      if (_$1.isFunction(onSuccess)) onSuccess(data);
    }).catch(function (error) {
      if (_$1.isFunction(onError)) onError(error);
    });
  } // create POST API Promise with Route and Options, then execute it and process results with callbacks

  function postAndCatchWithOptions(_ref5) {
    var route = _ref5.route,
        options = _ref5.options,
        picked = _ref5.picked,
        onSuccess = _ref5.onSuccess,
        onError = _ref5.onError;
    var method = 'POST';
    apiFetch({
      path: requestURL(route),
      method: method,
      data: !_$1.isEmpty(picked) ? _$1.pick(options, picked) : options
    }).then(function (data) {
      if (_$1.isFunction(onSuccess)) onSuccess(data);
    }).catch(function (error) {
      if (_$1.isFunction(onError)) onError(error);
    });
  }

  var fetch = /*#__PURE__*/Object.freeze({
    __proto__: null,
    ajaxDoAction: ajaxDoAction,
    ajaxUpdateOptions: ajaxUpdateOptions,
    toJSON: toJSON,
    requestURL: requestURL,
    fetchAndCatchWithOptions: fetchAndCatchWithOptions,
    postAndCatchWithOptions: postAndCatchWithOptions
  });

  // WordPress dependencies
  var _lodash = lodash,
      get = _lodash.get,
      map = _lodash.map,
      isEmpty = _lodash.isEmpty,
      isNil = _lodash.isNil,
      omitBy = _lodash.omitBy;
  var __ = wp.i18n.__;
  var _wp$element = wp.element,
      Fragment = _wp$element.Fragment,
      useCallback = _wp$element.useCallback;
  var _wp$components = wp.components,
      PanelBody = _wp$components.PanelBody,
      PanelRow = _wp$components.PanelRow,
      Button = _wp$components.Button,
      ExternalLink = _wp$components.ExternalLink,
      ToggleControl = _wp$components.ToggleControl,
      Spinner = _wp$components.Spinner; // Internal dependencies

  var ZukitSidebar = function ZukitSidebar(_ref) {
    var version = _ref.version,
        title = _ref.title,
        author = _ref.author,
        link = _ref.link,
        description = _ref.description,
        _ref$icon = _ref.icon,
        icon = _ref$icon === void 0 ? null : _ref$icon,
        more = _ref.more,
        actions = _ref.actions,
        actionLoading = _ref.actionLoading,
        debug = _ref.debug,
        ajaxAction = _ref.ajaxAction,
        options = _ref.options,
        updateOptions = _ref.updateOptions,
        panels = _ref.panels,
        updatePanels = _ref.updatePanels;
    var moreItems = omitBy(more, isNil);
    var pluginActions = omitBy(actions, isNil);
    var debugActions = omitBy(debug, isNil);
    var hasMoreItems = !isEmpty(moreItems);
    var hasActions = !isEmpty(pluginActions);
    var hasDebugActions = !isEmpty(debugActions) && get(panels, '_debug.value') === true;
    var hasPanels = !isEmpty(panels);
    var resetOptions = useCallback(function () {
      ajaxAction('reset_options', function (options) {
        return updateOptions(options, true);
      });
    }, [ajaxAction, updateOptions]);
    return /*#__PURE__*/React.createElement("div", {
      className: "block-editor-block-inspector"
    }, /*#__PURE__*/React.createElement("div", {
      className: "block-editor-block-card"
    }, icon, /*#__PURE__*/React.createElement("div", {
      className: "block-editor-block-card__content"
    }, /*#__PURE__*/React.createElement("h2", {
      className: "block-editor-block-card__title"
    }, title), /*#__PURE__*/React.createElement("span", {
      className: "block-editor-block-card__description"
    }, description))), /*#__PURE__*/React.createElement(PanelBody, {
      title: __('Plugin Info'),
      initialOpen: false
    }, /*#__PURE__*/React.createElement(PanelRow, null, /*#__PURE__*/React.createElement("span", null, __('Version')), /*#__PURE__*/React.createElement("span", null, version)), /*#__PURE__*/React.createElement(PanelRow, null, /*#__PURE__*/React.createElement("span", null, __('Author')), /*#__PURE__*/React.createElement(ExternalLink, {
      href: link
    }, author)), hasMoreItems && map(moreItems, function (_ref2, moreKey) {
      var label = _ref2.label,
          value = _ref2.value,
          link = _ref2.link;
      return /*#__PURE__*/React.createElement(PanelRow, {
        key: moreKey
      }, /*#__PURE__*/React.createElement("span", null, label), link ? /*#__PURE__*/React.createElement(ExternalLink, {
        href: link
      }, value) : /*#__PURE__*/React.createElement("span", null, value));
    }), /*#__PURE__*/React.createElement(PanelRow, null, /*#__PURE__*/React.createElement(Button, {
      className: "__plugin_actions admin-blue",
      icon: 'admin-settings',
      isSecondary: true,
      isLarge: true,
      onClick: resetOptions
    }, __('Reset Plugin Options')))), hasActions && /*#__PURE__*/React.createElement(PanelBody, {
      title: __('Actions'),
      initialOpen: true
    }, map(pluginActions, function (_ref3, actionKey) {
      var _mergeClasses;

      var label = _ref3.label,
          value = _ref3.value,
          icon = _ref3.icon,
          color = _ref3.color,
          help = _ref3.help,
          depends = _ref3.depends;
      return checkDependency(depends, options, true) && /*#__PURE__*/React.createElement(Fragment, {
        key: actionKey
      }, /*#__PURE__*/React.createElement(PanelRow, null, /*#__PURE__*/React.createElement(Button, {
        className: mergeClasses('__plugin_actions', (_mergeClasses = {}, _defineProperty(_mergeClasses, color, color), _defineProperty(_mergeClasses, 'is-loading', get(actionLoading, value)), _mergeClasses)),
        icon: icon,
        isSecondary: true,
        isLarge: true,
        onClick: function onClick() {
          return ajaxAction(value);
        }
      }, label, get(actionLoading, value) && /*#__PURE__*/React.createElement(Spinner, null))), help && /*#__PURE__*/React.createElement("p", {
        className: mergeClasses('__help', _defineProperty({}, color, color))
      }, help));
    })), hasPanels && /*#__PURE__*/React.createElement(PanelBody, {
      title: __('Screen Options'),
      initialOpen: false
    }, map(panels, function (_ref4, panelKey) {
      var label = _ref4.label,
          value = _ref4.value,
          help = _ref4.help;
      return /*#__PURE__*/React.createElement(ToggleControl, {
        key: panelKey,
        label: label,
        help: help,
        checked: value,
        onChange: function onChange() {
          return updatePanels(_defineProperty({}, panelKey, !value));
        }
      });
    })), hasDebugActions && /*#__PURE__*/React.createElement(PanelBody, {
      title: __('Debug Actions'),
      initialOpen: false
    }, map(debugActions, function (_ref5, actionKey) {
      var label = _ref5.label,
          value = _ref5.value,
          icon = _ref5.icon,
          color = _ref5.color;
      return /*#__PURE__*/React.createElement(PanelRow, {
        key: actionKey
      }, /*#__PURE__*/React.createElement(Button, {
        className: mergeClasses('__plugin_actions', _defineProperty({}, color, color)),
        icon: icon,
        isSecondary: true,
        isLarge: true,
        onClick: function onClick() {
          return ajaxAction(value);
        }
      }, label));
    })));
  };

  // WordPress dependencies
  var _lodash$1 = lodash,
      get$1 = _lodash$1.get; // const { __ } = wp.i18n;
  // const { useState, useCallback } = wp.element; // , useEffect

  var PanelBody$1 = wp.components.PanelBody; // Internal dependencies

  var ZukitPanel = function ZukitPanel(_ref) {
    var id = _ref.id,
        className = _ref.className,
        panels = _ref.panels,
        title = _ref.title,
        children = _ref.children,
        props = _objectWithoutProperties(_ref, ["id", "className", "panels", "title", "children"]);

    if (id !== undefined && !get$1(panels, "".concat(id, ".value"))) return null;
    return /*#__PURE__*/React.createElement(PanelBody$1, _extends({
      title: get$1(panels, "".concat(id, ".label")) || title,
      className: mergeClasses('zukit-panel', className)
    }, props), children);
  };

  var withZukitPanel = function withZukitPanel() {
    var panels = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    return function (props) {
      return /*#__PURE__*/React.createElement(ZukitPanel, _extends({
        panels: panels
      }, props));
    };
  };

  // WordPress dependencies
  var _lodash$2 = lodash,
      keys = _lodash$2.keys,
      has = _lodash$2.has,
      get$2 = _lodash$2.get,
      set = _lodash$2.set,
      includes = _lodash$2.includes,
      forEach = _lodash$2.forEach,
      pickBy = _lodash$2.pickBy,
      omit = _lodash$2.omit,
      mapValues = _lodash$2.mapValues,
      reduce = _lodash$2.reduce,
      first = _lodash$2.first,
      castArray = _lodash$2.castArray;
  var __$1 = wp.i18n.__;
  var compose = wp.compose.compose;
  var RawHTML = wp.element.RawHTML;
  var BlockIcon = wp.blockEditor.BlockIcon;
  var withNotices = wp.components.withNotices;
  var _wp$element$1 = wp.element,
      useState = _wp$element$1.useState,
      useCallback$1 = _wp$element$1.useCallback,
      useRef = _wp$element$1.useRef,
      useEffect = _wp$element$1.useEffect; // Internal dependencies

  var cprefix = 'zukit-skeleton';

  function availablePanels(panels, options) {
    return pickBy(panels, function (p) {
      return checkDependency(p, options);
    });
  }

  var ZukitSkeleton = function ZukitSkeleton(_ref) {
    var id = _ref.id,
        EditComponent = _ref.edit,
        _ref$options = _ref.options,
        initialOptions = _ref$options === void 0 ? {} : _ref$options,
        _ref$panels = _ref.panels,
        initialPanels = _ref$panels === void 0 ? {} : _ref$panels,
        _ref$info = _ref.info,
        info = _ref$info === void 0 ? {} : _ref$info,
        actions = _ref.actions,
        debug = _ref.debug,
        noticeUI = _ref.noticeUI,
        _ref$noticeOperations = _ref.noticeOperations,
        noticeOperations = _ref$noticeOperations === void 0 ? {} : _ref$noticeOperations;
    var createNotice = noticeOperations.createNotice;
    var hooks = useRef(null);

    var _useState = useState(initialOptions),
        _useState2 = _slicedToArray(_useState, 2),
        options = _useState2[0],
        setOptions = _useState2[1];

    var _useState3 = useState(initialPanels),
        _useState4 = _slicedToArray(_useState3, 2),
        panels = _useState4[0],
        setPanels = _useState4[1];

    var _useState5 = useState(info.more || {}),
        _useState6 = _slicedToArray(_useState5, 2),
        moreInfo = _useState6[0],
        setMoreInfo = _useState6[1];

    var _useState7 = useState( // create object {action_value: state}
    reduce(actions, function (acc, val) {
      return acc[val.value] = false, acc;
    }, {})),
        _useState8 = _slicedToArray(_useState7, 2),
        loading = _useState8[0],
        setLoading = _useState8[1];

    var updateLoading = useCallback$1(function (update) {
      var updateKey = first(keys(update)); // update only if we have this 'key' in 'loading'

      if (has(loading, updateKey)) {
        setLoading(function (prevLoading) {
          return _objectSpread2(_objectSpread2({}, prevLoading || {}), update || {});
        });
      }
    }, [loading]);
    var updateOptions = useCallback$1(function (update) {
      var reset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      // если 'reset' is true - вызываем c null вместо 'keys' что приведет к проверке всех 'hooks'
      if (reset) {
        ajaxUpdateOptions(null, {
          prev: options,
          next: update
        }, null, hooks.current);
      } else {
        ajaxUpdateOptions(keys(update), update, createNotice, hooks.current); // используем функцию 'set' вместо простого присвоения, потому что 'key'
        // может представлять из себя 'path'

        forEach(update, function (value, key) {
          return set(options, key, value);
        });
      } // если 'reset' is true - просто обновляем state значением из 'update'


      setOptions(_objectSpread2({}, reset ? update : options));
    }, [options, createNotice]);
    var ajaxAction = useCallback$1(function (params, callback) {
      ajaxDoAction(params, callback, createNotice, updateLoading);
    }, [createNotice, updateLoading]);
    var updatePanels = useCallback$1(function (update) {
      // используем функцию 'set' чтобы поменять только 'value', а не весь объект
      forEach(update, function (value, key) {
        return set(panels, "".concat(key, ".value"), value);
      }); // не используем функцию 'setOptions' чтобы не вызывать не нужное обновление 'options'
      // чтоб приведет к излишним renders - нам нужно только сохранить 'panels' в базе

      ajaxUpdateOptions('panels', mapValues(panels, function (p) {
        return p.value;
      }), createNotice);
      setPanels(_objectSpread2({}, panels));
    }, [panels, createNotice]);
    var setUpdateHook = useCallback$1(function (key, callback) {
      var keys = castArray(key); // create object for all keys {key: callback}

      var callbacks = reduce(keys, function (acc, val) {
        return acc[val] = callback, acc;
      }, {});
      hooks.current = _objectSpread2(_objectSpread2({}, hooks.current || {}), callbacks);
    }, []); // set hooks to update info.more items when dependency keys (in 'depends') are updated in 'options'

    useEffect(function () {
      var infoKeys = reduce(moreInfo, function (acc, value) {
        forEach(castArray(get$2(value, 'depends', [])), function (val) {
          return includes(acc, val) ? null : acc.push(val);
        });
        return acc;
      }, []);
      setUpdateHook(infoKeys, function () {
        ajaxAction('zukit_more_info', function (infoData) {
          setMoreInfo(get$2(infoData, 'more', {}));
        });
      });
    }, [moreInfo, setUpdateHook, ajaxAction]);
    var pluginEdit = !EditComponent ? null : /*#__PURE__*/React.createElement(EditComponent, {
      id: id,
      info: info,
      title: "".concat(info.title, " ").concat(__$1('Settings')) // panels={ panels }
      ,
      options: options,
      zukitPanel: withZukitPanel(panels),
      updateOptions: updateOptions,
      ajaxAction: ajaxAction,
      noticeOperations: noticeOperations,
      setUpdateHook: setUpdateHook
    });
    var pluginIcon = !info.icon ? null : /*#__PURE__*/React.createElement(BlockIcon, {
      icon: /*#__PURE__*/React.createElement(RawHTML, null, info.icon),
      showColors: true
    });
    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement("div", {
      className: "".concat(cprefix, " edit-post-layout is-mode-visual is-sidebar-opened block-editor-editor-skeleton")
    }, /*#__PURE__*/React.createElement("div", {
      className: "block-editor-editor-skeleton__body"
    }, /*#__PURE__*/React.createElement("div", {
      className: "block-editor-editor-skeleton__content",
      role: "region",
      "aria-label": "Settings content",
      tabIndex: "-1"
    }, /*#__PURE__*/React.createElement("div", {
      className: "components-editor-notices__dismissible"
    }, noticeUI), /*#__PURE__*/React.createElement("div", {
      className: "edit-post-visual-editor editor-styles-wrapper",
      tabIndex: "-1"
    }, /*#__PURE__*/React.createElement("div", {
      className: "block-editor-block-list__layout"
    }, /*#__PURE__*/React.createElement("div", {
      className: "wp-block block-editor-block-list__block"
    }, /*#__PURE__*/React.createElement("div", {
      className: "editor-post-title"
    }, /*#__PURE__*/React.createElement("div", {
      className: "wp-block editor-post-title__block"
    }, /*#__PURE__*/React.createElement("h1", null, info.title), pluginIcon)), pluginEdit)))), /*#__PURE__*/React.createElement("div", {
      className: "block-editor-editor-skeleton__sidebar",
      role: "region",
      "aria-label": "Plugin settings",
      tabIndex: "-1"
    }, /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("div", {
      className: "edit-post-sidebar"
    }, /*#__PURE__*/React.createElement(ZukitSidebar, _extends({
      id: id,
      icon: pluginIcon,
      more: moreInfo,
      actions: actions,
      actionLoading: loading,
      debug: debug,
      ajaxAction: ajaxAction,
      options: options,
      updateOptions: updateOptions,
      panels: availablePanels(panels, options),
      updatePanels: updatePanels,
      noticeOperations: noticeOperations
    }, omit(info, ['icon', 'more'])))))))));
  };

  var ZukitSkeleton$1 = compose([withNotices])(ZukitSkeleton);

  // WordPress dependencies
  var _lodash$3 = lodash,
      includes$1 = _lodash$3.includes; // const { __ } = wp.i18n;

  var defaultUnit = 'em';

  var ZukitDivider = function ZukitDivider(_ref) {
    var className = _ref.className,
        size = _ref.size,
        _ref$unit = _ref.unit,
        unit = _ref$unit === void 0 ? defaultUnit : _ref$unit;
    var sizeUnit = includes$1(unit, ['px', 'em', 'rem', '%']) ? unit : defaultUnit;
    var sizeValue = toRange(size, 0, 100);
    var style = sizeValue > 0 ? {
      marginBottom: "".concat(sizeValue).concat(sizeUnit),
      paddingTop: "".concat(sizeValue).concat(sizeUnit)
    } : null;
    return /*#__PURE__*/React.createElement("div", {
      className: mergeClasses('zukit-divider', className),
      style: style
    });
  };

  // WordPress dependencies
  var _lodash$4 = lodash,
      get$3 = _lodash$4.get,
      set$1 = _lodash$4.set,
      map$1 = _lodash$4.map,
      has$1 = _lodash$4.has,
      forEach$1 = _lodash$4.forEach,
      defaultsDeep = _lodash$4.defaultsDeep;
  var __$2 = wp.i18n.__;
  var _wp$element$2 = wp.element,
      render = _wp$element$2.render,
      Fragment$1 = _wp$element$2.Fragment;
  var _wp$components$1 = wp.components,
      ToggleControl$1 = _wp$components$1.ToggleControl,
      SelectControl = _wp$components$1.SelectControl,
      Button$1 = _wp$components$1.Button; // Internal dependencies
  var debugPanelKey = '_debug';
  function renderPlugin(pluginId) {
    var settings = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    var pluginData = externalData("".concat(pluginId, "_settings"));

    if (get$3(settings, 'panels') !== undefined) {
      // Add 'Debug Actions' panel defaults
      defaultsDeep(settings.panels, _defineProperty({}, debugPanelKey, {
        label: __$2('Debug Actions', 'zumedia'),
        value: false
      })); // Sync 'panels' with saved 'options' if presented

      if (get$3(pluginData, 'options.panels') !== undefined) {
        var panels = pluginData.options.panels;
        forEach$1(panels, function (value, key) {
          return set$1(settings, "panels.".concat(key, ".value"), value);
        });
      }
    }

    if (document.getElementById(pluginId) !== null) {
      render( /*#__PURE__*/React.createElement(ZukitSkeleton$1, _extends({
        id: pluginId
      }, pluginData, settings)), document.getElementById(pluginId));
    }
  }

  function checkDivider(item) {
    return has$1(item, 'divider') ? true : null;
  }

  function toggleOption(toggleOptions, options, updateOptions) {
    var withPath = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;

    var optionValue = function optionValue(k) {
      return get$3(options, withPath ? "".concat(withPath, ".").concat(k) : k);
    };

    return map$1(toggleOptions, function (item, key) {
      return checkDependency(item, options) && /*#__PURE__*/React.createElement(Fragment$1, {
        key: key
      }, /*#__PURE__*/React.createElement(ToggleControl$1, {
        label: item.label,
        help: item.help,
        checked: !!optionValue(key),
        onChange: function onChange() {
          return updateOptions(_defineProperty({}, key, !optionValue(key)));
        }
      }), checkDivider(item) && /*#__PURE__*/React.createElement(ZukitDivider, {
        size: item.divider
      }));
    });
  }
  function selectOption(value, option, updateOptions) {
    var id = option.id,
        _option$options = option.options,
        options = _option$options === void 0 ? [] : _option$options,
        _option$label = option.label,
        label = _option$label === void 0 ? '' : _option$label,
        help = option.help,
        defaultValue = option.defaultValue;
    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement("label", {
      className: "components-base-control__label __select_label",
      htmlFor: id
    }, label), /*#__PURE__*/React.createElement("div", {
      className: "__select_block"
    }, /*#__PURE__*/React.createElement("div", {
      className: "__select_control"
    }, /*#__PURE__*/React.createElement(SelectControl, {
      id: id,
      value: value,
      onChange: function onChange(value) {
        return updateOptions(_defineProperty({}, id, value));
      },
      options: options
    }), /*#__PURE__*/React.createElement(Button$1, {
      isSecondary: true,
      className: "__reset",
      onClick: function onClick() {
        return updateOptions(_defineProperty({}, id, defaultValue));
      }
    }, __$2('Reset'))), /*#__PURE__*/React.createElement("p", {
      className: "components-base-control__help"
    }, help)));
  }

  var render$1 = /*#__PURE__*/Object.freeze({
    __proto__: null,
    renderPlugin: renderPlugin,
    toggleOption: toggleOption,
    selectOption: selectOption
  });

  // Conditional Wrap Component
  // condition ? wrap(children) : children
  var ConditionalWrap = function ConditionalWrap(_ref) {
    var className = _ref.className,
        condition = _ref.condition,
        elseDiv = _ref.elseDiv,
        wrappingDiv = _ref.wrappingDiv,
        wrappingLink = _ref.wrappingLink,
        wrap = _ref.wrap,
        children = _ref.children,
        additionalProps = _objectWithoutProperties(_ref, ["className", "condition", "elseDiv", "wrappingDiv", "wrappingLink", "wrap", "children"]);

    // maybe Wrapping Component is <div>
    var wrappingComponent = !wrappingDiv ? null : /*#__PURE__*/React.createElement("div", _extends({
      className: className
    }, additionalProps), children); // maybe Wrapping Component is <a>

    if (wrappingLink) wrappingComponent = /*#__PURE__*/React.createElement("a", _extends({
      className: className
    }, additionalProps), children); // if wrappingComponent is still undefined then use "wrap" as component

    if (!wrappingComponent) {
      var Wrap = wrap;
      wrappingComponent = /*#__PURE__*/React.createElement(Wrap, _extends({
        className: className
      }, additionalProps), children);
    }

    return condition ? wrappingComponent : elseDiv ? /*#__PURE__*/React.createElement("div", {
      className: className
    }, children) : children;
  };

  // WordPress dependencies
  var _lodash$5 = lodash,
      map$2 = _lodash$5.map,
      defaults = _lodash$5.defaults,
      upperFirst = _lodash$5.upperFirst,
      isFunction = _lodash$5.isFunction,
      isPlainObject = _lodash$5.isPlainObject,
      every = _lodash$5.every,
      pick = _lodash$5.pick;
  var _wp$components$2 = wp.components,
      BaseControl = _wp$components$2.BaseControl,
      Tooltip = _wp$components$2.Tooltip,
      Button$2 = _wp$components$2.Button,
      ButtonGroup = _wp$components$2.ButtonGroup; // Internal dependencies

  var cname = 'zukit-select-item';
  var buttonPossibleProps = ['href', 'target', 'disabled', 'icon', 'iconSize', 'shortcut', 'onMouseDown', 'isPrimary', 'isTertiary', 'isPressed', 'isBusy', 'isDefault', 'isLink', 'isDestructive'];

  var SelectItem = function SelectItem(_ref) {
    var className = _ref.className,
        _ref$columns = _ref.columns,
        columns = _ref$columns === void 0 ? 2 : _ref$columns,
        _ref$isSecondary = _ref.isSecondary,
        isSecondary = _ref$isSecondary === void 0 ? true : _ref$isSecondary,
        _ref$isSmall = _ref.isSmall,
        isSmall = _ref$isSmall === void 0 ? true : _ref$isSmall,
        withoutControl = _ref.withoutControl,
        recap = _ref.recap,
        options = _ref.options,
        selectedItem = _ref.selectedItem,
        transformValue = _ref.transformValue,
        beforeItem = _ref.beforeItem,
        afterItem = _ref.afterItem,
        label = _ref.label,
        help = _ref.help,
        buttonStyle = _ref.buttonStyle,
        buttonClass = _ref.buttonClass,
        withLabels = _ref.withLabels,
        withTooltip = _ref.withTooltip,
        _onClick = _ref.onClick,
        additionalProps = _objectWithoutProperties(_ref, ["className", "columns", "isSecondary", "isSmall", "withoutControl", "recap", "options", "selectedItem", "transformValue", "beforeItem", "afterItem", "label", "help", "buttonStyle", "buttonClass", "withLabels", "withTooltip", "onClick"]);

    var makeItem = function makeItem(_ref2) {
      var _mergeClasses;

      var label = _ref2.label,
          value = _ref2.value,
          style = _ref2.style,
          isDisabled = _ref2.isDisabled;
      return /*#__PURE__*/React.createElement(ConditionalWrap, {
        condition: withTooltip,
        wrap: Tooltip,
        text: label,
        key: getKey(value, label)
      }, /*#__PURE__*/React.createElement("div", {
        key: getKey(value, label),
        className: mergeClasses("".concat(cname, "__button-wrapper"), "".concat(cname, "__").concat(value), (_mergeClasses = {}, _defineProperty(_mergeClasses, 'is-selected', selectedItem === value && !isDisabled), _defineProperty(_mergeClasses, 'is-disabled', isDisabled), _mergeClasses))
      }, /*#__PURE__*/React.createElement(Button$2, _extends({
        className: mergeClasses("".concat(cname, "__button"), buttonClass, "".concat(cname, "__").concat(value), _defineProperty({}, 'is-selected', selectedItem === value && !isDisabled)),
        isSecondary: isSecondary,
        isSmall: isSmall,
        onClick: function onClick() {
          return isDisabled ? false : _onClick(value);
        },
        style: style || buttonStyle
      }, pick(additionalProps, buttonPossibleProps)), isFunction(transformValue) ? transformValue(value) : value), withLabels && /*#__PURE__*/React.createElement("div", {
        className: "block-editor-block-styles__item-label"
      }, label)));
    };

    var defaultRecapOptions = {
      label: upperFirst(selectedItem),
      value: selectedItem,
      style: null,
      isDisabled: true
    };
    var recapOptions = isPlainObject(recap) ? defaults(recap, defaultRecapOptions) : defaultRecapOptions;
    var selectOptions = every(options, function (o) {
      return isPlainObject(o);
    }) ? options : map$2(options, function (o) {
      return {
        label: upperFirst(o),
        value: o
      };
    });
    return /*#__PURE__*/React.createElement(ConditionalWrap, {
      condition: !withoutControl,
      elseDiv: true,
      wrap: BaseControl,
      className: mergeClasses(cname, "__".concat(columns, "columns"), 'components-base-control', className),
      label: label,
      help: help
    }, /*#__PURE__*/React.createElement(ButtonGroup, {
      "aria-label": label
    }, beforeItem, recap && makeItem(recapOptions), map$2(selectOptions, makeItem), afterItem));
  };

  // WordPress dependencies
  var _lodash$6 = lodash,
      map$3 = _lodash$6.map,
      get$4 = _lodash$6.get,
      isNil$1 = _lodash$6.isNil,
      isPlainObject$1 = _lodash$6.isPlainObject; // const { __ } = wp.i18n;
  // const { compose } = wp.compose;
  // const { useState, useCallback } = wp.element; // , useEffect

  var RawHTML$1 = wp.element.RawHTML;
  var _wp$components$3 = wp.components,
      Spinner$1 = _wp$components$3.Spinner,
      Tooltip$1 = _wp$components$3.Tooltip;
  var BlockIcon$1 = wp.blockEditor.BlockIcon; // Internal dependencies

  var ZukitTable = function ZukitTable(_ref) {
    var className = _ref.className,
        fixed = _ref.fixed,
        config = _ref.config,
        head = _ref.head,
        body = _ref.body,
        loading = _ref.loading;

    // style={ style }"white-space: pre-wrap;"
    var _ref2 = config || {},
        _ref2$align = _ref2.align,
        cellAlign = _ref2$align === void 0 ? [] : _ref2$align,
        _ref2$style = _ref2.style,
        cellStyle = _ref2$style === void 0 ? [] : _ref2$style,
        _ref2$className = _ref2.className,
        cellClass = _ref2$className === void 0 ? [] : _ref2$className;

    var withContent = function withContent(data) {
      if (!isPlainObject$1(data)) return data;
      var dashicon = data.dashicon,
          svg = data.svg,
          tooltip = data.tooltip;
      var icon = /*#__PURE__*/React.createElement(BlockIcon$1, {
        icon: svg ? /*#__PURE__*/React.createElement(RawHTML$1, null, svg) : dashicon,
        showColors: true
      });
      return !tooltip ? icon : /*#__PURE__*/React.createElement(Tooltip$1, {
        text: tooltip
      }, /*#__PURE__*/React.createElement("div", null, icon));
    };

    var withStyle = function withStyle(index, style) {
      var commonStyle = get$4(cellStyle, index);
      if (isNil$1(style) && !commonStyle) return null;
      return _objectSpread2(_objectSpread2({}, commonStyle || {}), style || {});
    };

    var withClass = function withClass(index, align) {
      var _ref3;

      var commonClass = get$4(cellClass, index);
      var commonAlign = align || get$4(cellAlign, index) || 'left';
      return _ref3 = {}, _defineProperty(_ref3, commonClass || '', commonClass), _defineProperty(_ref3, "has-text-align-".concat(commonAlign), commonAlign), _ref3;
    };

    return /*#__PURE__*/React.createElement("div", {
      className: mergeClasses('zukit-table', className, {
        'has-fixed-layout': fixed,
        'is-loading': loading
      })
    }, /*#__PURE__*/React.createElement("div", {
      className: "head"
    }, head && map$3(head, function (_ref4, cellIndex) {
      var content = _ref4.content,
          align = _ref4.align,
          style = _ref4.style;
      return /*#__PURE__*/React.createElement("div", {
        className: mergeClasses('cell', 'head', withClass(cellIndex, align)),
        key: cellIndex,
        "aria-label": "Header label",
        style: withStyle(cellIndex, style)
      }, content);
    })), /*#__PURE__*/React.createElement("div", {
      className: "body"
    }, body && map$3(body, function (cells, rowIndex) {
      return /*#__PURE__*/React.createElement("div", {
        className: "row",
        key: rowIndex
      }, map$3(cells, function (_ref5, cellIndex) {
        var content = _ref5.content,
            align = _ref5.align,
            style = _ref5.style;
        return /*#__PURE__*/React.createElement("div", {
          className: mergeClasses('cell', withClass(cellIndex, align)),
          key: cellIndex,
          "aria-label": "",
          style: withStyle(cellIndex, style)
        }, withContent(content));
      }));
    }), loading && /*#__PURE__*/React.createElement(Spinner$1, null)));
  };

  // Components

  var components = /*#__PURE__*/Object.freeze({
    __proto__: null,
    ConditionalWrap: ConditionalWrap,
    ZukitDivider: ZukitDivider,
    ZukitPanel: ZukitPanel,
    SelectItem: SelectItem,
    ZukitSidebar: ZukitSidebar,
    ZukitSkeleton: ZukitSkeleton$1,
    ZukitTable: ZukitTable
  });

  wp.zukit = {
    render: render$1,
    fetch: fetch,
    utils: utils,
    components: components
  };

}());
//# sourceMappingURL=zukit.min.js.map
